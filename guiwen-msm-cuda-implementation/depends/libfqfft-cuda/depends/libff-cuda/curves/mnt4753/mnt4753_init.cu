#ifndef __MNT4753_INIT_CU__
#define __MNT4753_INIT_CU__

#include "mnt4753_g1.cuh"
#include "mnt4753_g2.cuh"

namespace libff {
 
__device__ Fp_params<mnt4753_r_limbs> mnt4753_fp_params_r;
__device__ Fp_params<mnt4753_q_limbs> mnt4753_fp_params_q;
__device__ Fp2_params<mnt4753_q_limbs> mnt4753_fp2_params_q;
__device__ Fp4_params<mnt4753_q_limbs> mnt4753_fp4_params_q;

__device__ mnt4753_Fq2* mnt4753_twist;
__device__ mnt4753_Fq2* mnt4753_twist_coeff_a;
__device__ mnt4753_Fq2* mnt4753_twist_coeff_b;
__device__ mnt4753_Fq* mnt4753_twist_mul_by_a_c0;
__device__ mnt4753_Fq* mnt4753_twist_mul_by_a_c1;
__device__ mnt4753_Fq* mnt4753_twist_mul_by_b_c0;
__device__ mnt4753_Fq* mnt4753_twist_mul_by_b_c1;
__device__ mnt4753_Fq* mnt4753_twist_mul_by_q_X;
__device__ mnt4753_Fq* mnt4753_twist_mul_by_q_Y;

struct mnt4753_G1_params;
struct mnt4753_G2_params;

__device__ mnt4753_G1_params g1_params;
__device__ mnt4753_G2_params g2_params;

__device__ bigint<mnt4753_q_limbs>* mnt4753_ate_loop_count;
__device__ bool mnt4753_ate_is_loop_count_neg;
__device__ bigint<4*mnt4753_q_limbs>* mnt4753_final_exponent;
__device__ bigint<mnt4753_q_limbs>* mnt4753_final_exponent_last_chunk_abs_of_w0;
__device__ bool mnt4753_final_exponent_last_chunk_is_w0_neg;
__device__ bigint<mnt4753_q_limbs>* mnt4753_final_exponent_last_chunk_w1;

__device__ void init_mnt4753_params()
{
    typedef bigint<mnt4753_r_limbs> bigint_r;
    typedef bigint<mnt4753_q_limbs> bigint_q;

    assert(sizeof(mp_limb_t_) == 8 || sizeof(mp_limb_t_) == 4);

    // fr
    mnt4753_fp_params_r.modulus = new bigint_r("41898490967918953402344214791240637128170709919953949071783502921025352812571106773058893763790338921418070971888458477323173057491593855069696241854796396165721416325350064441470418137846398469611935719059908164220784476160001");
    if (sizeof(mp_limb_t_) == 8)
    {
        mnt4753_fp_params_r.Rsquared = new bigint_r("528294247489794478830892053472659225778251862527177273996458536178202249935611532598626300863882178545714358789568805911817755538413250244866201145158388475219888075448690235278457757610027799964891022754525136858589282224337");
        mnt4753_fp_params_r.Rcubed = new bigint_r("41633340690057738012868713380844953084100062694720651354492878278511227226750918309707975231298706403293537406447047613688567102129544491565970474558910742579333982008790051581932943967272974145862229340445509069597750977867213");
        mnt4753_fp_params_r.inv = 0xc90776e23fffffff;
        
    }
    if (sizeof(mp_limb_t_) == 4)
    {
        mnt4753_fp_params_r.Rsquared = new bigint_r("528294247489794478830892053472659225778251862527177273996458536178202249935611532598626300863882178545714358789568805911817755538413250244866201145158388475219888075448690235278457757610027799964891022754525136858589282224337");
        mnt4753_fp_params_r.Rcubed = new bigint_r("41633340690057738012868713380844953084100062694720651354492878278511227226750918309707975231298706403293537406447047613688567102129544491565970474558910742579333982008790051581932943967272974145862229340445509069597750977867213");
        mnt4753_fp_params_r.inv = 0x3fffffff;
    }

    mnt4753_fp_params_r.num_bits = 753;
    mnt4753_fp_params_r.euler = new bigint_r("20949245483959476701172107395620318564085354959976974535891751460512676406285553386529446881895169460709035485944229238661586528745796927534848120927398198082860708162675032220735209068923199234805967859529954082110392238080000");
    mnt4753_fp_params_r.s = 30;
    mnt4753_fp_params_r.t = new bigint_r("39021010480745652133919498688765463538626870065884617224134041854204007249857398469987226430131438115069708760723898631821547688442835449306011425196003537779414482717728302293895201885929702287178426719326440397855625");
    mnt4753_fp_params_r.t_minus_1_over_2 = new bigint_r("19510505240372826066959749344382731769313435032942308612067020927102003624928699234993613215065719057534854380361949315910773844221417724653005712598001768889707241358864151146947600942964851143589213359663220198927812");
    mnt4753_fp_params_r.multiplicative_generator = new bigint_r("17");
    mnt4753_fp_params_r.root_of_unity = new bigint_r("5431548564651772770863376209190533321743766006080874345421017090576169920304713950094628043692772801995471539849411522704471393987882883355624697206026582300050878644000631322086989454860102191886653186986980927065212650747291");
    mnt4753_fp_params_r.nqr = new bigint_r("11");
    mnt4753_fp_params_r.nqr_to_t = new bigint_r("2455648623996886823239043525257449186291028346951286533043435811383049212810466344106778185245641952169091724588148805743116830521168785810979147404935397979718632700247111860253397218855647411901871200410401085305824670182498");
    mnt4753_fp_params_r.zero = new mnt4753_Fr(&mnt4753_fp_params_r);
    mnt4753_fp_params_r.zero->init_zero();
    mnt4753_fp_params_r.one = new mnt4753_Fr(&mnt4753_fp_params_r);
    mnt4753_fp_params_r.one->init_one();

    //fq
    mnt4753_fp_params_q.modulus = new bigint_q("41898490967918953402344214791240637128170709919953949071783502921025352812571106773058893763790338921418070971888253786114353726529584385201591605722013126468931404347949840543007986327743462853720628051692141265303114721689601");
    if (sizeof(mp_limb_t_) == 8)
    {
        mnt4753_fp_params_q.Rsquared = new bigint_q("3905329767828791615502162626850211818655714094458690120430986575792677496633802118724780745619552999481121157852051288948780064150889938934414916554522736667272858589954728849781314241493825915233155383114266348177232527200456");
        mnt4753_fp_params_q.Rcubed = new bigint_q("37585233426682165294065702410202415171476938145667339674403960805833165033715513237837083555904292153853777922114133104918156213519695206603971179794826432236755764454444622189193631114536609372479504766361480176984626948994196");
        mnt4753_fp_params_q.inv = 0xf2044cfbe45e7fff;
    }
    if (sizeof(mp_limb_t_) == 4)
    {
        mnt4753_fp_params_q.Rsquared = new bigint_q("3905329767828791615502162626850211818655714094458690120430986575792677496633802118724780745619552999481121157852051288948780064150889938934414916554522736667272858589954728849781314241493825915233155383114266348177232527200456");
        mnt4753_fp_params_q.Rcubed = new bigint_q("37585233426682165294065702410202415171476938145667339674403960805833165033715513237837083555904292153853777922114133104918156213519695206603971179794826432236755764454444622189193631114536609372479504766361480176984626948994196");
        mnt4753_fp_params_q.inv = 0xe45e7fff;
    }

    mnt4753_fp_params_q.num_bits = 753;
    mnt4753_fp_params_q.euler = new bigint_q("20949245483959476701172107395620318564085354959976974535891751460512676406285553386529446881895169460709035485944126893057176863264792192600795802861006563234465702173974920271503993163871731426860314025846070632651557360844800");
    mnt4753_fp_params_q.s = 15;
    mnt4753_fp_params_q.t = new bigint_q("1278640471433073529124274133033466709233725278318907137200424283478556909563327233064541435662546964154604216671394463687571830033251476599169665701965732619291119517454523942352538645255842982596454713491581459512424155325");
    mnt4753_fp_params_q.t_minus_1_over_2 = new bigint_q("639320235716536764562137066516733354616862639159453568600212141739278454781663616532270717831273482077302108335697231843785915016625738299584832850982866309645559758727261971176269322627921491298227356745790729756212077662");
    mnt4753_fp_params_q.multiplicative_generator = new bigint_q("17");
    mnt4753_fp_params_q.root_of_unity = new bigint_q("40577822398412982719876671814347622311725878559400100565221223860226396934830112376659822430317692232440883010225033880793828874730711721234325694240460855741763791540474706150170374090550695427806583236301930157866709353840964");
    mnt4753_fp_params_q.nqr = new bigint_q("13");
    mnt4753_fp_params_q.nqr_to_t = new bigint_q("18017781208150291467483603956987567350418056191877119616553128888924963195174389973716060278346059199161001506497199268678284023657157367321346359874121888331150637273273499500012599908057395792036980306166250353261196001983326");
    mnt4753_fp_params_q.zero = new mnt4753_Fr(&mnt4753_fp_params_q);
    mnt4753_fp_params_q.zero->init_zero();
    mnt4753_fp_params_q.one = new mnt4753_Fr(&mnt4753_fp_params_q);
    mnt4753_fp_params_q.one->init_one();

    //fq2
    mnt4753_fp2_params_q.fp_params = &mnt4753_fp_params_q;
    mnt4753_fp2_params_q.euler = new bigint<2*mnt4753_q_limbs>("877741772694393058372135237733343629593473856016002229857105035140194750058493748062049287411694733142989075570064889940236970783493032261937016406277000694377203416101839277893740346880847050301763334478688551750308947816122818534553695997573207707013723499671859487825892935302013472750294519116226330295520189278343056719919731322734884690958148824900524215249232306591740915846271438433919136803359438630765991579935915053953640737747135454095769600");
    mnt4753_fp2_params_q.s = 16;
    mnt4753_fp2_params_q.t = new bigint<2*mnt4753_q_limbs>("26786553121777131908329322440592762133589900391113349299838410496221763612624931276307656476186973057342195909730984190070708336898591072446808362007965109081335553469904763119315806484400849923759867385213884025583158807865076249223440429613440176605643417348384383783749174050964766624459671603888742989975591713816621604001456644370571432219181787869278693092322763262687405879097639112363254907329084430870544176633786470152393821342380842715325");
    mnt4753_fp2_params_q.t_minus_1_over_2 = new bigint<2 * mnt4753_q_limbs>("13393276560888565954164661220296381066794950195556674649919205248110881806312465638153828238093486528671097954865492095035354168449295536223404181003982554540667776734952381559657903242200424961879933692606942012791579403932538124611720214806720088302821708674192191891874587025482383312229835801944371494987795856908310802000728322185285716109590893934639346546161381631343702939548819556181627453664542215435272088316893235076196910671190421357662");
    mnt4753_fp2_params_q.non_residue = new bigint_q("13");
    mnt4753_fp2_params_q.nqr_c0 = new bigint_q("8");
    mnt4753_fp2_params_q.nqr_c1 = new bigint_q("1");
    mnt4753_fp2_params_q.nqr_to_t_c0 = new bigint_q("0");
    mnt4753_fp2_params_q.nqr_to_t_c1 = new bigint_q("18228376547502796301079156126471485588453635788107513320149028052132560276470102392885009336437739088956604407962162420327485713003335768904427163750664343990955988139858371693866291895311721436398000747370090550705505161050692");
    mnt4753_fp2_params_q.Frobenius_coeffs_c1[0] = new bigint_q("1");
    mnt4753_fp2_params_q.Frobenius_coeffs_c1[1] = new bigint_q("41898490967918953402344214791240637128170709919953949071783502921025352812571106773058893763790338921418070971888253786114353726529584385201591605722013126468931404347949840543007986327743462853720628051692141265303114721689600");

    //fq4
    mnt4753_fp4_params_q.fp2_params = &mnt4753_fp2_params_q;
    mnt4753_fp4_params_q.non_residue = new bigint_q("13");
    mnt4753_fp4_params_q.Frobenius_coeffs_c1[0] = new bigint_q("1");
    mnt4753_fp4_params_q.Frobenius_coeffs_c1[1] = new bigint_q("18691656569803771296244054523431852464958959799019013859007259692542121208304602539555350517075508287829753932558576476751900235650227380562700444433662761577027341858128610410779088384480737679672900770810745291515010467307990");
    mnt4753_fp4_params_q.Frobenius_coeffs_c1[2] = new bigint_q("41898490967918953402344214791240637128170709919953949071783502921025352812571106773058893763790338921418070971888253786114353726529584385201591605722013126468931404347949840543007986327743462853720628051692141265303114721689600");
    mnt4753_fp4_params_q.Frobenius_coeffs_c1[3] = new bigint_q("23206834398115182106100160267808784663211750120934935212776243228483231604266504233503543246714830633588317039329677309362453490879357004638891167538350364891904062489821230132228897943262725174047727280881395973788104254381611");

    //
    g1_params.coeff_a = new mnt4753_Fq(&mnt4753_fp_params_q, "2");
    g1_params.coeff_b = new mnt4753_Fq(&mnt4753_fp_params_q, "28798803903456388891410036793299405764940372360099938340752576406393880372126970068421383312482853541572780087363938442377933706865252053507077543420534380486492786626556269083255657125025963825610840222568694137138741554679540");

    mnt4753_Fq non_residue = mnt4753_Fq(&mnt4753_fp_params_q, *mnt4753_fp2_params_q.non_residue);

    mnt4753_twist = new mnt4753_Fq2(&mnt4753_fp2_params_q, *mnt4753_fp_params_q.zero, *mnt4753_fp_params_q.one);
    mnt4753_twist_coeff_a = new mnt4753_Fq2(&mnt4753_fp2_params_q, *g1_params.coeff_a * non_residue, *mnt4753_fp_params_q.zero);
    mnt4753_twist_coeff_b = new mnt4753_Fq2(&mnt4753_fp2_params_q, *mnt4753_fp_params_q.zero, *g1_params.coeff_b * non_residue);

    g2_params.twist = new mnt4753_Fq2(*mnt4753_twist);
    g2_params.coeff_a = new mnt4753_Fq2(*mnt4753_twist_coeff_a);
    g2_params.coeff_b = new mnt4753_Fq2(*mnt4753_twist_coeff_b);
    mnt4753_twist_mul_by_a_c0 = new mnt4753_Fq(*g1_params.coeff_a * non_residue);
    mnt4753_twist_mul_by_a_c1 = new mnt4753_Fq(*g1_params.coeff_a * non_residue);
    mnt4753_twist_mul_by_b_c0 = new mnt4753_Fq(*g1_params.coeff_b * non_residue.squared());
    mnt4753_twist_mul_by_b_c1 = new mnt4753_Fq(*g1_params.coeff_b * non_residue);
    mnt4753_twist_mul_by_q_X = new mnt4753_Fq(&mnt4753_fp_params_q, "41898490967918953402344214791240637128170709919953949071783502921025352812571106773058893763790338921418070971888253786114353726529584385201591605722013126468931404347949840543007986327743462853720628051692141265303114721689600");
    mnt4753_twist_mul_by_q_Y = new mnt4753_Fq(&mnt4753_fp_params_q, "18691656569803771296244054523431852464958959799019013859007259692542121208304602539555350517075508287829753932558576476751900235650227380562700444433662761577027341858128610410779088384480737679672900770810745291515010467307990");


    // g1
    mnt4753_Fq fq_t(&mnt4753_fp_params_q);
    g1_params.fr_params = &mnt4753_fp_params_r;
    g1_params.fq_params = &mnt4753_fp_params_q;
    g1_params.G1_zero_X = new mnt4753_Fq(fq_t.zero());
    g1_params.G1_zero_Y = new mnt4753_Fq(fq_t.one());
    g1_params.G1_zero_Z = new mnt4753_Fq(fq_t.zero());
    g1_params.G1_one_X = new mnt4753_Fq(&mnt4753_fp_params_q, "23803503838482697364219212396100314255266282256287758532210460958670711284501374254909249084643549104668878996224193897061976788052185662569738774028756446662400954817676947337090686257134874703224133183061214213216866019444443");
    g1_params.G1_one_Y = new mnt4753_Fq(&mnt4753_fp_params_q, "21091012152938225813050540665280291929032924333518476279110711148670464794818544820522390295209715531901248676888544060590943737249563733104806697968779796610374994498702698840169538725164956072726942500665132927942037078135054");
    g1_params.G1_one_Z = new mnt4753_Fq(fq_t.one());

    g1_params.wnaf_window_table = new size_t[4];
    g1_params.wnaf_window_table_size = 4;
    g1_params.wnaf_window_table[0] = 11;
    g1_params.wnaf_window_table[1] = 24;
    g1_params.wnaf_window_table[2] = 60;
    g1_params.wnaf_window_table[3] = 127;

    g1_params.fixed_base_exp_window_table_length = new size_t[22];
    g1_params.fixed_base_exp_window_table_length_size = 22;
    g1_params.fixed_base_exp_window_table_length[0] = 1;
    g1_params.fixed_base_exp_window_table_length[1] = 5;
    g1_params.fixed_base_exp_window_table_length[2] = 10;
    g1_params.fixed_base_exp_window_table_length[3] = 25;
    g1_params.fixed_base_exp_window_table_length[4] = 60;
    g1_params.fixed_base_exp_window_table_length[5] = 144;
    g1_params.fixed_base_exp_window_table_length[6] = 345;
    g1_params.fixed_base_exp_window_table_length[7] = 855;
    g1_params.fixed_base_exp_window_table_length[8] = 1805;
    g1_params.fixed_base_exp_window_table_length[9] = 3912;
    g1_params.fixed_base_exp_window_table_length[10] = 11265;
    g1_params.fixed_base_exp_window_table_length[11] = 27898;
    g1_params.fixed_base_exp_window_table_length[12] = 57597;
    g1_params.fixed_base_exp_window_table_length[13] = 145299;
    g1_params.fixed_base_exp_window_table_length[14] = 157205;
    g1_params.fixed_base_exp_window_table_length[15] = 601601;
    g1_params.fixed_base_exp_window_table_length[16] = 1107377;
    g1_params.fixed_base_exp_window_table_length[17] = 1789647;
    g1_params.fixed_base_exp_window_table_length[18] = 4392627;
    g1_params.fixed_base_exp_window_table_length[19] = 8221211;
    g1_params.fixed_base_exp_window_table_length[20] = 0;
    g1_params.fixed_base_exp_window_table_length[21] = 42363731;

    // g2
    mnt4753_Fq2 fq2_t(&mnt4753_fp2_params_q);
    g2_params.fr_params = &mnt4753_fp_params_r;
    g2_params.fq_params = &mnt4753_fp_params_q;
    g2_params.fq2_params = &mnt4753_fp2_params_q;

    g2_params.G2_zero_X = new mnt4753_Fq2(fq2_t.zero());
    g2_params.G2_zero_Y = new mnt4753_Fq2(fq2_t.one());
    g2_params.G2_zero_Z = new mnt4753_Fq2(fq2_t.zero());

    g2_params.G2_one_X = new mnt4753_Fq2(&mnt4753_fp2_params_q, 
                                            mnt4753_Fq(&mnt4753_fp_params_q, "22367666623321080720060256844679369841450849258634485122226826668687008928557241162389052587294939105987791589807198701072089850184203060629036090027206884547397819080026926412256978135536735656049173059573120822105654153939204"),
                                            mnt4753_Fq(&mnt4753_fp_params_q, "19674349354065582663569886390557105215375764356464013910804136534831880915742161945711267871023918136941472003751075703860943205026648847064247080124670799190998395234694182621794580160576822167228187443851233972049521455293042"));
    g2_params.G2_one_Y = new mnt4753_Fq2(&mnt4753_fp2_params_q, 
                                            mnt4753_Fq(&mnt4753_fp_params_q, "6945425020677398967988875731588951175743495235863391886533295045397037605326535330657361771765903175481062759367498970743022872494546449436815843306838794729313050998681159000579427733029709987073254733976366326071957733646574"),
                                            mnt4753_Fq(&mnt4753_fp_params_q, "17406100775489352738678485154027036191618283163679980195193677896785273172506466216232026037788788436442188057889820014276378772936042638717710384987239430912364681046070625200474931975266875995282055499803236813013874788622488"));
    g2_params.G2_one_Z = new mnt4753_Fq2(fq2_t.one());

    g2_params.wnaf_window_table = new size_t[4];
    g2_params.wnaf_window_table_size = 4;
    g2_params.wnaf_window_table[0] = 5;
    g2_params.wnaf_window_table[1] = 15;
    g2_params.wnaf_window_table[2] = 39;
    g2_params.wnaf_window_table[3] = 109;

    g2_params.fixed_base_exp_window_table_length = new size_t[22];
    g2_params.fixed_base_exp_window_table_length_size = 22;
    g2_params.fixed_base_exp_window_table_length[0] = 1;
    g2_params.fixed_base_exp_window_table_length[1] = 4;
    g2_params.fixed_base_exp_window_table_length[2] = 10;
    g2_params.fixed_base_exp_window_table_length[3] = 25;
    g2_params.fixed_base_exp_window_table_length[4] = 60;
    g2_params.fixed_base_exp_window_table_length[5] = 143;
    g2_params.fixed_base_exp_window_table_length[6] = 345;
    g2_params.fixed_base_exp_window_table_length[7] = 821;
    g2_params.fixed_base_exp_window_table_length[8] = 1794;
    g2_params.fixed_base_exp_window_table_length[9] = 3920;
    g2_params.fixed_base_exp_window_table_length[10] = 11301;
    g2_params.fixed_base_exp_window_table_length[11] = 18960;
    g2_params.fixed_base_exp_window_table_length[12] = 44199;
    g2_params.fixed_base_exp_window_table_length[13] = 0;
    g2_params.fixed_base_exp_window_table_length[14] = 150800;
    g2_params.fixed_base_exp_window_table_length[15] = 548695;
    g2_params.fixed_base_exp_window_table_length[16] = 1051769;
    g2_params.fixed_base_exp_window_table_length[17] = 2023926;
    g2_params.fixed_base_exp_window_table_length[18] = 3787109;
    g2_params.fixed_base_exp_window_table_length[19] = 7107480;
    g2_params.fixed_base_exp_window_table_length[20] = 0;
    g2_params.fixed_base_exp_window_table_length[21] = 38760027;

    // pairing paramters
    mnt4753_ate_loop_count = new bigint_q("204691208819330962009469868104636132783269696790011977400223898462431810102935615891307667367766898917669754470400");
    mnt4753_ate_is_loop_count_neg = false;
    mnt4753_final_exponent_last_chunk_abs_of_w0 = new bigint_q("204691208819330962009469868104636132783269696790011977400223898462431810102935615891307667367766898917669754470399");
    mnt4753_final_exponent_last_chunk_is_w0_neg = false;
    mnt4753_final_exponent_last_chunk_w1 = new bigint_q("1");
}

}


#endif